<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../css/section1.css">
    <link rel="stylesheet" href="../css/animate.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/js/all.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.min.js"></script>
    <title>酒駕情境體驗</title>
</head>

<body>
    <div class="container">
        <div class="little-container" >
            <div class="title">酒駕情境體驗</div>
            <audio >
                <!-- <source src="horse.ogg" type="audio/ogg"> -->
                <source src="../music/1.mp3" type="audio/mpeg">
              <!-- Your browser does not support the audio element. -->
              </audio>
            <div class="img" onclick="showGame()" >
                <div class="big-title  animated fadeIn">你知道<span style="color: yellow">「酒駕」</span>要付出什麼代價嗎？</div>
                <div class="btn  animated fadeIn"><i class="fas fa-gavel rotate"></i>進入遊戲</div>
            </div>
            <div class="question1" style="display:none;">
                <div class="left"><img src="../image/lin2.png" alt=""></div>
                <div class="right flex-right">
                    <div class="right" id="main">
                        <div class="upper" id="typing1"></div>
                    </div>
                    <div class="right"  id='section1' style="display: none;" >
                        <!-- <div class="upper"><img src="../image/drink.png" alt=""></div> -->
                        <div class="middle"><span>一般酒駕</span>近1年人數區間選項請點選(請選擇)</div>
                        <div class="down" >
                            <div class="down-circle">
                                <div class="down-c" id="two-1" onclick="answer(1,'two-1')"><div class="down-c-l"></div></div>
                                <div class="down-q">50-59%</div>
                            </div>
                            <div class="down-circle">
                                <div class="down-c" id="two-2" onclick="answer(1,'two-2')"><div class="down-c-l"></div></div>
                                <div class="down-q">60-69%</div>
                            </div>
                            <div class="down-circle" id="two-3" onclick="answer(1,'two-3')">
                                <div class="down-c"><div class="down-c-l"></div></div>
                                <div class="down-q">70-79%</div>
                            </div>
                            <div class="down-circle" id="two-4" onclick="answer(1,'two-4')">
                                <div class="down-c"><div class="down-c-l"></div></div>
                                <div class="down-q">80-89%</div>
                            </div>
                            <div class="down-circle" id="two-5" onclick="answer(1,'two-5')">
                                <div class="down-c"><div class="down-c-l"></div></div>
                                <div class="down-q">90%以上</div>
                            </div>
                        </div>
                    </div>
                    <div class="right" id='section2' style="display: none;" >
                        <!-- <div class="upper"><img src="../image/drink.png" alt=""></div> -->
                        <div class="middle"><span>酒駕致死或致重傷</span>近1年人數區間選項請點選</div>
                        <div class="down" >
                            <div class="down-circle">
                                <div class="down-c" id="two-1" onclick="answer(2,'two-1')"><div class="down-c-l"></div></div>
                                <div class="down-q">50-59%</div>
                            </div>
                            <div class="down-circle">
                                <div class="down-c" id="two-2" onclick="answer(2,'two-2')"><div class="down-c-l"></div></div>
                                <div class="down-q">60-69%</div>
                            </div>
                            <div class="down-circle" id="two-3" onclick="answer(2,'two-3')">
                                <div class="down-c"><div class="down-c-l"></div></div>
                                <div class="down-q">70-79%</div>
                            </div>
                            <div class="down-circle" id="two-4" onclick="answer(2,'two-4')">
                                <div class="down-c"><div class="down-c-l"></div></div>
                                <div class="down-q">80-89%</div>
                            </div>
                            <div class="down-circle" id="two-5" onclick="answer(2,'two-5')">
                                <div class="down-c"><div class="down-c-l"></div></div>
                                <div class="down-q">90%以上</div>
                            </div>
                        </div>
                    </div>
                    <div class="right" style="display:none;" id='section3'>
                        <!-- <div class="upper"><img src="../image/drink.png" alt=""></div> -->
                        <div class="middle"><span>正確答案</span></div>
                        <div class="down" >
                            <div class="down-circle">
                                <div class="down-c"><div class="down-c-l"></div></div>
                                <div class="down-q">50-59%</div>
                            </div>
                            <div class="down-circle">
                                <div class="down-c"><div class="down-c-l" style="width:15px; height: 15px; border-radius: 50%;background-color: #3DB1ff;;"></div></div>
                                <div class="down-q">60-69%</div>
                            </div>
                            <div class="down-circle">
                                <div class="down-c"><div class="down-c-l"></div></div>
                                <div class="down-q">70-79%</div>
                            </div>
                            <div class="down-circle">
                                <div class="down-c"><div class="down-c-l"></div></div>
                                <div class="down-q">80-89%</div>
                            </div>
                            <div class="down-circle right">
                                <div class="down-c"><div class="down-c-l"></div></div>
                                <div class="down-q">90%以上</div>
                            </div>
                        </div>
                        <div class="send">
                            <div class="sendbtn info" onclick="showStatic()">統計數據</div>
                            <a href="./section2.html"><div class="nextbtn gray" style="display: none;" onclick="next()">下ㄧ關</div></a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal" style="display: none;" id="fault">
                <div class="modal-content">
                    <span class="close" id="faultclose">&times;</span>
                    <p class="fault"><i class="fas fa-times"></i>      答錯囉</p>
                    <div onclick="showAnswer()" class="watch-answer">看解答</div>
                  </div>
            </div>
            <div class="modal" style="display: none;" id="right">
                <div class="modal-content">
                    <span class="close" id="rightclose">&times;</span>
                    <p class="right"><i class="far fa-thumbs-up"></i>      答對了</p>
                  </div>
            </div>
            <div class="modal"  id="static" style='display: none;'>
                <div class="modal-content">
                    <span class="close" id="staticclose">&times;</span>
                    <div class="big-title">統計小學堂</div>
                    <div class="statics">
                        <div class="left"><img src="../image/lin2.png" alt="老師"></div>
                        <div class="analysis">
                            <div class="text">近6年酒駕案件偵查終結50萬5,578人，以聲請簡易判決處刑占62.5%最多(高於全般刑案之19.9%)，其次為緩起訴處分占27.7%</div>
                            <canvas id="Chart" width="700" height="300"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        var str = '某一晚的下班，我跟好馬吉小林吃飯，途中大家開心喝了幾杯，吃完要回家時，他竟然要開車回家，聰明的你，可以幫我跟小林說現在起訴比率有多高嗎？';
        var i = 0;

        var ctx = document.getElementById('Chart').getContext('2d');
        var myChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['103年', '104年', '105年', '106年', '107年', '108年'],
                datasets: [{
                    label: '酒駕起訴比率',
                    data: [60.2, 62.5, 63.2, 64.2, 63.2, 62.0],
                    backgroundColor: [
                        'rgba(255, 99, 132, 0.2)',
                        'rgba(255, 99, 132, 0.2)',
                        'rgba(255, 99, 132, 0.2)',
                        'rgba(255, 99, 132, 0.2)',
                        'rgba(255, 99, 132, 0.2)',
                        'rgba(255, 99, 132, 0.2)',
                    ],
                    borderColor: [
                        'rgba(255, 99, 132, 0.2)',
                        'rgba(255, 99, 132, 0.2)',
                        'rgba(255, 99, 132, 0.2)',
                        'rgba(255, 99, 132, 0.2)',
                        'rgba(255, 99, 132, 0.2)',
                        'rgba(255, 99, 132, 0.2)',
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    yAxes: [{
                        ticks: {
                            beginAtZero: true
                        }
                    }]
                },
                responsive: false,
            }
        });


        function typing() {
            var divTyping = document.getElementById('typing1');
            var moive_status = document.querySelector("audio").paused;
            
            if (i <= str.length) {
                divTyping.innerHTML = str.slice(0, i++) + '_';
                setTimeout('typing()', 150); //遞歸調用
                // console.log(moive_status);
                var people = document.querySelector(".left img");
                if(i >= 2 && i <= 5 ){
                    people.src = "../image/lin3.png";
                }else if (i > 5 && i % 2 == 0 ){
                    people.src = "../image/lin4.png";
                }else if (i > 5 && i % 2 == 1 ){
                    people.src = "../image/lin5.png";
                }
            } else  {
                divTyping.innerHTML = str; //結束打字,移除 _ 光標
                document.getElementById("section1").setAttribute('style', 'display:flex');
            }
        }

        function answer(num ,answer){
             // Get the modal
             if(num == 1){
                if(answer == "two-2"){
                    var modal = document.getElementById("right");
                    modal.style.display = "block";
                    document.getElementById("section3").style.display = 'block';
                     document.querySelector("#section3 .nextbtn").setAttribute("style", "display:block;");
                }else{
                    var modal = document.getElementById("fault");
                    modal.style.display = "block";       
                }         
             }else{
                if(answer == "two-1"){
                    var modal = document.getElementById("right");
                    modal.style.display = "block";
                }else{
                    var modal = document.getElementById("fault");
                    modal.style.display = "block";       
                }  
                document.querySelector("#section2 .nextbtn").setAttribute("style", "display:block;");
             }
             

        }

        function chooseQuestoin(num){
            if(num == 1){
                document.getElementById("main").setAttribute("style", "display:none;");
                document.getElementById("section1").setAttribute("style", "display:flex;");
            }else{
                document.getElementById("main").setAttribute("style", "display:none;");
                document.getElementById("section2").setAttribute("style", "display:flex;");
            }
            
        }

    
        // Get the <span> element that closes the modal
        var rightclose = document.getElementById("rightclose");
        var faultclose = document.getElementById("faultclose");
        var modalBtn = document.querySelectorAll(".modal-content");
        // When the user clicks on the button, open the modal

        // When the user clicks on <span> (x), close the modal
        rightclose.onclick = function() {
             var modal = document.getElementById("right");
             modal.style.display = "none";
        };
        faultclose.onclick = function() {
             var modal = document.getElementById("fault");
             modal.style.display = "none";
        };

        for(var j =0; j < modalBtn.length;j++){
            modalBtn[j].addEventListener('click',function(){
            document.getElementById("right").style.display = "none";
            document.getElementById("fault").style.display = "none";
            document.getElementById("static").style.display = "none";
            });
        }
        
        window.onclick = function(event) {
            var right = document.getElementById("right");
            var fault = document.getElementById("fault");
            if (event.target == right) {
                right.style.display = "none";
            }
            if (event.target == fault) {
                fault.style.display = "none";
            }
        }

        function showGame(){
            document.querySelector(".question1").setAttribute("style", "display: flex;");
            document.querySelector(".img").setAttribute("style", "display: none;");
            typing();
            var audio = document.querySelector("audio");
            audio.play();
        }

        function showAnswer(){
            var modal = document.getElementById("fault");
            modal.style.display = "none";
            document.getElementById("section3").style.display = 'block';
            document.querySelector("#section3 .nextbtn").setAttribute("style", "display:block;");
        }

        function showStatic(){
            document.getElementById("static").style.display = 'block';
        }

        
    </script>
</body>

</html>