<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../css/section4.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/js/all.min.js"></script>
    <title>特徵通-年齡</title>
</head>

<body>
    <div class="container">
        <div class="little-container">
            <div class="title">特徵通-年齡</div>
            <div class="question1">
                <div class="left"><img src="../image/lin2.png" alt=""></div>
                <div class="right" id="main">
                    <div class="upper" id="typing1"></div>
                    <div class="middle" id ="middle" style="display: none;">
                        <img src="../image/Lessthan20.svg"  id="Lessthan20" draggable="true" ondragstart="drag(event)" alt="Lessthan20">
                        <img src="../image/20to30years.svg" id="20to30years" draggable="true" ondragstart="drag(event)"  alt="20to30years">
                        <img src="../image/30to40years.svg"  id="30to40years" draggable="true" ondragstart="drag(event)" alt="Lessthan20">
                        <img src="../image/40to50years.svg"  id="40to50years" draggable="true" ondragstart="drag(event)" alt="Lessthan20">
                        <img src="../image/50to60years.svg"  id="50to60years" draggable="true" ondragstart="drag(event)" alt="Lessthan20">
                        <img src="../image/Over60years.svg"  id="Over60years" draggable="true" ondragstart="drag(event)" alt="Lessthan20">
                    </div>
                    <div class="down" id ="question1" style="display: none;">
                        <div class="name">男性集中在</div>
                        <div class="answer" ondrop="drop(event)" ondragover="allowDrag(event)"></div>
                        <div class="btn" onclick="show()">送出</div>
                        <a href="section5.html"><div class="nextbtn">下一關</div></a>
                    </div>
                </div>
            </div>
            <div class="modal" style="display: none;" id="fault">
                <div class="modal-content">
                    <span class="close" id="faultclose">&times;</span>
                    <p class="fault"><i class="fas fa-times"></i>      答錯囉</p>
                    <div>看解答</div>
                  </div>
            </div>
            <div class="modal" style="display: none;" id="right">
                <div class="modal-content">
                    <span class="close" id="rightclose">&times;</span>
                    <p class="right"><i class="far fa-thumbs-up"></i>      答對了</p>
                    <div>看解答</div>
                  </div>
            </div>
            <!-- <a href="./section2.html" id="next" style="display: none;" class="next">下一關</a> -->
        </div>
    </div>

    <script>
        var str = '你覺得哪個年齡層最多？<br>(請將年齡拖曳至下方區塊)';
        // var str = '1'
        var i = 0;

        function typing() {
            var divTyping = document.getElementById('typing1');
            if (i <= str.length) {
                divTyping.innerHTML = str.slice(0, i++) + '_';
                setTimeout('typing()', 100); //遞歸調用
            } else {
                divTyping.innerHTML = str; //結束打字,移除 _ 光標
                // document.getElementById('next').setAttribute('style', 'display:block');
                document.getElementById("question1").setAttribute('style', 'display:flex');
                document.getElementById("middle").setAttribute('style', 'display:block');
            }
        }

        // Get the <span> element that closes the modal
        var rightclose = document.getElementById("rightclose");
        var faultclose = document.getElementById("faultclose");

        // When the user clicks on the button, open the modal

        // When the user clicks on <span> (x), close the modal
        rightclose.onclick = function() {
             var modal = document.getElementById("right");
             modal.style.display = "none";
        };
        faultclose.onclick = function() {
             var modal = document.getElementById("fault");
             modal.style.display = "none";
        };

        window.onclick = function(event) {
            var right = document.getElementById("right");
            var fault = document.getElementById("fault");
            if (event.target == right) {
                right.style.display = "none";
            }
            if (event.target == fault) {
                fault.style.display = "none";
            }
        }

        function show(){
           var rightAnswer = "50to60years";
           var guessAnswer =  document.querySelector(".answer").firstChild.id;
           if(rightAnswer == guessAnswer){
                showModal("right");
           }else{
                showModal("fault");
           }
        }

        function showModal(status){
            document.querySelector("#" + status).setAttribute("style", "display:block");
            document.querySelector(".nextbtn").setAttribute("style", "display: block");
        }


        typing();

        function drag(event){
            event.dataTransfer.setData('text', event.target.id);
        }

        function allowDrag(event){
            event.preventDefault();
        }

        function drop(event){
            event.preventDefault();
            if(event.target.tagName == "DIV"){
                // event.preventDefault();
                var data = event.dataTransfer.getData('text');
                event.target.appendChild(document.getElementById(data));
            }else if(event.target.tagName == "IMG"){
                var data = event.dataTransfer.getData('text');
                div = event.target.outerHTML;
                document.querySelector("#middle").innerHTML += div;
                document.querySelector(".answer").innerHTML = "";
                document.querySelector(".answer").appendChild(document.getElementById(data));
            }
            document.querySelector(".btn").setAttribute("style", "display: block");
        }
    </script>
</body>

</html>